<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>ORACLE之视图和系统函数 | Yhchdev</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">ORACLE之视图和系统函数</h1><a id="logo" href="/.">Yhchdev</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/jinengshu/"><i class="fa fa-tree"> 技能</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">ORACLE之视图和系统函数</h1><div class="post-meta">May 6, 2018</div><div class="post-content"><h4 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h4><h5 id="视图是什么？"><a href="#视图是什么？" class="headerlink" title="视图是什么？"></a>视图是什么？</h5><p>视图（View）是从一个或多个表（或视图）导出的表。视图与数据库中的<strong>物理表</strong>不同，视图是一个<strong>虚表</strong>(它的本质是一个SQL查询)，即视图所对应的数据不进行实际存储，数据库中<strong>只存储视图</strong>的定义，在对视图的数据进行操作时，系统根据视图的定义去操作与视图相关联的基本表。</p>
<h5 id="视图有什么作用？"><a href="#视图有什么作用？" class="headerlink" title="视图有什么作用？"></a>视图有什么作用？</h5><ul>
<li><p>安全性：限制数据访问<br>(通过视图来访问数据表，仅返回指定的数据)</p>
</li>
<li><p>查询简化、结构简化：使得复杂的查询容易<br>(将经常使用的SQL复杂查询，创建为视图，通过查询视图和SQL语句的结合，达到相同的效果)</p>
</li>
<li>与更改隔离：提供数据的独立性(例如： 如果应用建立在数据库表上，当数据库表发生变化时，可以在表上建立视图，通过视图屏蔽表的变化，从而应用程序可以不动)</li>
<li>便利性：表现相同数据的不同观察</li>
<li>数据完整性</li>
</ul>
<h5 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">view</span> V_viewname</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">SQL</span>语句</span><br></pre></td></tr></table></figure>
<ul>
<li>示例：创建学生平均成绩视图(ViewStudAvgScore)其中包括学生学号、学生姓名、平均分、总分 、 最 高 分 、 最 低 分 、 课 程 门 数 ，即(StudNo,StudName,AvgScore,SumScore,MaxScore,MinScore,CountCourse)字段。</li>
</ul>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="built_in">replace</span> V_StudAvgScore <span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> studno,studname,<span class="built_in">avg</span>(studscore) avgscore,<span class="built_in">max</span>(studscore) 最高分,<span class="built_in">min</span>(studscore) 最低分,<span class="built_in">count</span>(*) 课程门数</span><br><span class="line"><span class="keyword">from</span> studinfo <span class="keyword">join</span> studscoreinfo</span><br><span class="line"><span class="keyword">using</span>(studno)</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> studno,studname</span><br></pre></td></tr></table></figure>    
<ul>
<li>使用视图</li>
</ul>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> V_StudAvgScore</span><br></pre></td></tr></table></figure>    
<p><img src="/2018/05/06/ORACLE之视图和系统函数/picone.PNG" alt="picone"></p>
<h4 id="序列"><a href="#序列" class="headerlink" title="序列"></a>序列</h4><h5 id="什么是序列"><a href="#什么是序列" class="headerlink" title="什么是序列?"></a>什么是序列?</h5><p>序列(SEQUENCE)是<strong>序列号生成器</strong>，可以为表中的行自动生成序列号(经常与<strong>触发器</strong>配合使用，从而实现<strong>ID的自动增长</strong>)，产生一组等间隔的数值(类型为数字)。不占用磁盘空间，占用内存。其主要用途是生成表的主键值，可以在插入语句中引用，也可以通过查询检查当前值，或使序列增至下一个值。</p>
<h5 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h5><h5 id="创建序列"><a href="#创建序列" class="headerlink" title="创建序列"></a>创建序列</h5><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">create</span> <span class="selector-tag">sequence</span> <span class="selector-attr">[sequencename]</span></span><br><span class="line"><span class="selector-attr">[increment by n]</span> <span class="comment">//步长,如果省略，则默认为1,可以是负数表示递减</span></span><br><span class="line"><span class="selector-attr">[start with n]</span><span class="comment">//序列的初值</span></span><br><span class="line"><span class="selector-attr">[maxvalue n]</span><span class="comment">//序列的最大值</span></span><br><span class="line"><span class="selector-attr">[minvalue n]</span><span class="comment">//序列的最小值,</span></span><br><span class="line"><span class="selector-attr">[&#123;cycle | nocycle&#125;]</span> <span class="comment">//序列达到最大值是否循环</span></span><br><span class="line"><span class="selector-attr">[&#123;cache n | nocache&#125;]</span> <span class="comment">//缓存区的大小</span></span><br></pre></td></tr></table></figure>
<ul>
<li>补充</li>
</ul>
<p>1.最大值和最小值可以不指定,最简单的序列指定步长和初值就可以了;</p>
<p>2.CYCLE和NOCYCLE 表示当序列生成器的值达到限制值后是否循环。CYCLE代表循环，NOCYCLE代表不循环。如果循环，则当递增序列达到最大值时，循环到最小值;对于递减序列达到最小值时，循环到最大值。如果不循环，达到限制值后，继续产生新值就会发生错误。</p>
<p>3.CACHE(缓冲)定义存放序列的内存块的大小，默认为20。NOCACHE表示不对序列进行内存缓冲。对序列进行内存缓冲，可以改善序列的性能。大量语句发生请求，申请序列时，为了避免序列在运用层实现序列而引起的性能瓶颈。Oracle序列允许将序列提前生成 cache x个先存入内存，在发生大量申请序列语句时，可直接到运行最快的内存中去得到序列。但cache个数也不能设置太大，因为在数据库重启时，会清空内存信息，预存在内存中的序列会丢失，当数据库再次启动后，序列从上次内存中最大的序列号+1 开始存入cachex个。这种情况也能会在数据库关闭时也会导致序号不连续。</p>
<h5 id="使用序列"><a href="#使用序列" class="headerlink" title="使用序列"></a>使用序列</h5><ul>
<li>currval–返回序列的当前值</li>
<li>nextval–返回序列的下一个可用值</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">//创建表</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> TestSeq</span><br><span class="line">(</span><br><span class="line">AutoID <span class="built_in">int</span>,</span><br><span class="line"><span class="keyword">Name</span> varchar2(<span class="number">20</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">//创建序列</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">sequence</span> SeqID</span><br><span class="line"><span class="keyword">start</span> <span class="keyword">with</span> <span class="number">1001</span>//初始值</span><br><span class="line"><span class="keyword">increment</span> <span class="keyword">by</span> <span class="number">1</span> //步长</span><br><span class="line"></span><br><span class="line">//触发器实现自动编号</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">trigger</span> trig_Testseq</span><br><span class="line"><span class="keyword">before</span> <span class="keyword">insert</span> <span class="keyword">on</span> TestSeq</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">declare</span> AID <span class="built_in">int</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">select</span> seqid.nextval <span class="keyword">into</span> AID <span class="keyword">from</span> dual;</span><br><span class="line">    :new.AutoID:=AID;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>    
<p><img src="/2018/05/06/ORACLE之视图和系统函数/pictwo.PNG" alt="pictwo"></p>
<ul>
<li><p>PS</p>
<p><strong>这里的序列出现断层(跳号)，是什么原因？</strong></p>
<p>其实这正好验证了上面的补充3，这个序列是我4天前为写触发器那篇博客定义的，现在我再次插入，预存在cache中的序列丢失了，默认cach中存放了20个序列，那<strong>为什么不是1021呢？</strong>，这里又涉及到导致跳号的另一个原因,因为我刚才写错了一条insert语句，因此序列有从1021，跳到了1022,我实验了几次发现确实是这样，发现<strong>错误的插入也会导致序列跳号</strong>,这可能是oracle的设计缺陷，也可能另有用处，但是即便如此，<strong>序列还是保证了唯一性</strong></p>
</li>
</ul>
<h4 id="系统函数"><a href="#系统函数" class="headerlink" title="系统函数"></a>系统函数</h4><h5 id="字符串处理函数"><a href="#字符串处理函数" class="headerlink" title="字符串处理函数"></a>字符串处理函数</h5><ul>
<li>大小写转换函数</li>
</ul>
<ol>
<li>lower(column|expression):转换字符值为小写</li>
<li>upper(column|expression):转换字符值为大写 </li>
<li>initcap(column|expression):转换每个单词的首字母为大写，其他所有字母为小写</li>
</ol>
<p><img src="/2018/05/06/ORACLE之视图和系统函数/picthree.PNG" alt="picthree"></p>
<ul>
<li>CONCAT 连接字符函数</li>
</ul>
<ol>
<li>语法：concat(column1|expression,(column2|expression))</li>
<li>说明:和  || 等价</li>
</ol>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">concat</span>(studno,studname) <span class="keyword">from</span> studinfo</span><br><span class="line"><span class="keyword">select</span> studno||studname <span class="keyword">from</span> studinfo</span><br></pre></td></tr></table></figure>    
<ul>
<li>SUBSTR 求字串</li>
</ul>
<ol>
<li>语法：substr (column1|expression,m,[n])</li>
<li><p>说明:</p>
<p> –第一个字符索引为1</p>
<p> –返回开始位置为m,长为n的字符串</p>
<p> –若m为负数，从字符串末尾开始计数</p>
<p> –若不指定n返回到字符串结束的所有字符</p>
</li>
</ol>
<p><img src="/2018/05/06/ORACLE之视图和系统函数/picfour.PNG" alt="picfour"></p>
<ul>
<li>LENGTH 求字符串的长度</li>
</ul>
<ol>
<li>语法：length(column1|expression)</li>
<li>说明: 返回字符数</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">length</span>(<span class="string">'oracle'</span>) <span class="keyword">from</span> dual</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">length</span>(<span class="string">'从删库到跑路'</span>) <span class="keyword">from</span> dual</span><br><span class="line">//返回值均为 <span class="number">6</span></span><br></pre></td></tr></table></figure>    
<ul>
<li>INSTR 查找字串的位置</li>
</ul>
<ol>
<li>语法: (column1|expression,‘string’,[m],[n]）</li>
<li><p>说明:</p>
<p> –返回一个字符串的数字位置。</p>
<p> – m作为查找的开始，在字符串中第n次发现的位置。</p>
<p> – m和n的默认值是1</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">instr</span>(<span class="string">'banana'</span>,<span class="string">'b'</span>) <span class="keyword">from</span> dual</span><br><span class="line">//<span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">instr</span>(<span class="string">'banana'</span>,<span class="string">'a'</span>) <span class="keyword">from</span> dual</span><br><span class="line">//<span class="keyword">return</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">instr</span>(<span class="string">'banana'</span>,<span class="string">'a'</span>,<span class="number">2</span>) <span class="keyword">from</span> dual</span><br><span class="line">//<span class="keyword">return</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">instr</span>(<span class="string">'banana'</span>,<span class="string">'a'</span>,<span class="number">1</span>,<span class="number">2</span>) <span class="keyword">from</span> dual</span><br><span class="line">//<span class="keyword">return</span> <span class="number">4</span></span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">instr</span>(<span class="string">'banana'</span>,<span class="string">'a'</span>,<span class="number">1</span>,<span class="number">3</span>) <span class="keyword">from</span> dual</span><br><span class="line">//<span class="keyword">return</span> <span class="number">6</span></span><br></pre></td></tr></table></figure>    
<ul>
<li>REPLACE:替换字符串位置</li>
</ul>
<ol>
<li>语法：replace(text,search_string,replacement_string)</li>
<li>说明:在txt中，查找search_string,如果找到用replacement_string代替它</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">replace</span>(<span class="string">'my name is yanghaocheng'</span>,<span class="string">'yanghaocheng'</span>,<span class="string">'yhch'</span>) <span class="keyword">test</span> <span class="keyword">from</span> dual</span><br><span class="line">//<span class="keyword">return</span> <span class="string">'my name is yhch'</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>TRIM 截取字符串</li>
</ul>
<ol>
<li>语法：trim(leading|trailing|both,trim_character from trim_source)</li>
<li><p>说明: </p>
<p> –从一个字符串修整头或尾字符(或两者)。</p>
<p> –-若trim_character或trim_source是字符，必须放在单引号中</p>
<p> –截取集只能有一个字符</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">trim</span>(<span class="string">'y'</span> <span class="keyword">from</span> <span class="string">'yanghaocheng'</span>) <span class="keyword">test</span> <span class="keyword">from</span> dual</span><br><span class="line">//<span class="keyword">return</span> <span class="string">'anghaocheng'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">trim</span>(<span class="string">'n'</span> <span class="keyword">from</span> <span class="string">'yanghaocheng'</span>) <span class="keyword">test</span> <span class="keyword">from</span> dual</span><br><span class="line">//<span class="keyword">return</span> <span class="string">'yanghaochen'</span> </span><br></pre></td></tr></table></figure>    
<ul>
<li>LTRIM 去左串</li>
</ul>
<ol>
<li>语法：ltrim(source_sting,trim_string)</li>
<li>说明: 从source_string最左边去除trimstring</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line"><span class="keyword">select</span> <span class="keyword">ltrim</span> (<span class="string">'yanghaocheng'</span>,<span class="string">'yang'</span>) <span class="keyword">from</span> dual</span><br><span class="line">//<span class="keyword">return</span> <span class="string">'haocheng'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">ltrim</span> (<span class="string">'yanghaocheng'</span>,<span class="string">'hao'</span>) <span class="keyword">from</span> dual</span><br><span class="line">//<span class="keyword">return</span> <span class="string">'yanghaocheng'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">ltrim</span> (<span class="string">'yanghaocheng'</span>,<span class="string">'y'</span>) <span class="keyword">from</span> dual</span><br><span class="line">//<span class="keyword">return</span> <span class="string">'anghaocheng'</span></span><br></pre></td></tr></table></figure>    
<ul>
<li>RTRIM 去右串</li>
</ul>
<ol>
<li>语法：rtrim(source_string,rtrim_string)</li>
<li>说明:从source_string最右边去除rtrim_string</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">rtrim</span> (<span class="string">'yanghaocheng'</span>,<span class="string">'cheng'</span>) <span class="keyword">from</span> dual</span><br><span class="line">//<span class="keyword">return</span> <span class="string">'yanghao'</span></span><br></pre></td></tr></table></figure>  
<ul>
<li>LPAD,RPAD 填充字符串</li>
</ul>
<ol>
<li><p>语法：lpad/rpad(column1|expression,n,string)</p>
</li>
<li><p>说明: 填充字符值左、右调节到n字符位置的总宽度</p>
</li>
</ol>
<ul>
<li>小结</li>
</ul>
<table>
<thead>
<tr>
<th>function</th>
<th>result</th>
</tr>
</thead>
<tbody>
<tr>
<td>concat(‘Hello’,’Word’)</td>
<td>HelloWord </td>
</tr>
<tr>
<td>substr(‘HelloWord’,1,5)</td>
<td>Hello </td>
</tr>
<tr>
<td>length (‘HelloWord’)</td>
<td>10 </td>
</tr>
<tr>
<td>instr (‘HelloWord’,’w’)</td>
<td>6</td>
</tr>
<tr>
<td>trim(‘H’ from ‘HelloWorld’)</td>
<td>elloWord</td>
</tr>
</tbody>
</table>
<h5 id="数字函数"><a href="#数字函数" class="headerlink" title="数字函数"></a>数字函数</h5><ul>
<li><p>ROUND(column|expression, n) </p>
<p>四舍五入列、表达式或值为n位小数位，或者，如果n被忽略，无小数位。(如果n是负值，小数点左边左边的数被四舍五入)</p>
</li>
</ul>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">round</span>(<span class="number">3.14</span>,<span class="number">1</span>) <span class="keyword">from</span> dual //<span class="keyword">return</span> <span class="number">3.1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">round</span>(<span class="number">3.14</span>) <span class="keyword">from</span> dual //<span class="keyword">return</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">round</span>(<span class="number">3.389</span>,<span class="number">2</span>) <span class="keyword">from</span> dual //<span class="keyword">return</span> <span class="number">3.39</span></span><br></pre></td></tr></table></figure>    
<ul>
<li><p>TRUNC(column|expression,n) </p>
<p>截断列、表达式或值到n位小数，或者，如果n被忽略，那么n默认为0</p>
</li>
</ul>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">trunc</span>(<span class="number">3.1415926</span>) <span class="keyword">from</span> dual //<span class="keyword">return</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">trunc</span>(<span class="number">3.1415926</span>,<span class="number">3</span>) <span class="keyword">from</span> dual //<span class="keyword">return</span> <span class="number">3.141</span>(仅仅是截断)</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">trunc</span>(<span class="number">3.1415926</span>,<span class="number">6</span>) <span class="keyword">from</span> dual //<span class="keyword">return</span> <span class="number">3.141592</span></span><br></pre></td></tr></table></figure>  
<ul>
<li><p>MOD(m,n)</p>
<p>返回m除以n的余数</p>
</li>
</ul>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">mod</span>(<span class="number">4</span>,<span class="number">10</span>) <span class="keyword">from</span> dual <span class="comment">//return 4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">mod</span>(<span class="number">58</span>,<span class="number">5</span>) <span class="keyword">from</span> dual <span class="comment">// return 3</span></span><br></pre></td></tr></table></figure>    
<h5 id="日期函数"><a href="#日期函数" class="headerlink" title="日期函数"></a>日期函数</h5><ul>
<li><p>Oracle 数据库用内部数字格式存储日期：世纪，年<br>，月，日，小时，分钟和秒</p>
</li>
<li><p>默认日期显示格式是DD-MON-RR.</p>
</li>
<li><p>修改默认日期格式</p>
<p>– ALTER SESSION SET NLS_DATE_FORMAT =‘date format model’;</p>
<p>– 示例：<br>ALTER SESSION SET NLS_DATE_FORMAT=<br>‘YYYY-MM-DD’</p>
</li>
<li><p>extract </p>
</li>
</ul>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">语法: extract(<span class="built_in">year</span>/moth/<span class="built_in">day</span> <span class="keyword">from</span> studbirthday)</span><br><span class="line">select extract(<span class="built_in">year</span> <span class="keyword">from</span> studbirthday) birthyear <span class="keyword">from</span> studinfo</span><br></pre></td></tr></table></figure>    
<p><img src="/2018/05/06/ORACLE之视图和系统函数/picfive.PNG" alt="picfive"></p>
<h5 id="表达式"><a href="#表达式" class="headerlink" title="表达式"></a>表达式</h5><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CASE</span> <span class="keyword">WHEN</span> boolean_expr1 <span class="keyword">THEN</span> return_expr1</span><br><span class="line">     [<span class="keyword">WHEN</span> boolean_expr2 <span class="keyword">THEN</span> return_expr2</span><br><span class="line">     <span class="keyword">WHEN</span> boolean_exprn <span class="keyword">THEN</span> return_exprn</span><br><span class="line">     <span class="keyword">ELSE</span> else_expr]</span><br><span class="line"><span class="keyword">END</span> 列别名</span><br></pre></td></tr></table></figure>    
<p>示列: 在学生成绩信息表(StudScoreInfo)和学生信息表(StudInfo)中将求出的平均分按以下等级输出。（包括学号，姓名，性别，出生日期，平均分，等级字段）<br>平均分 等级<br>90—100 ‘优秀’<br>80—90 ‘优良’<br>70—80 ‘一般’<br>60—70 ‘及格’<br>60 以下 ‘不及格’<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> studno,studname, 平均分,</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">when</span> 平均分 <span class="keyword">between</span> <span class="number">90</span> <span class="keyword">and</span> <span class="number">100</span> <span class="keyword">then</span> <span class="string">'优秀'</span></span><br><span class="line">     <span class="keyword">when</span> 平均分 <span class="keyword">between</span> <span class="number">80</span> <span class="keyword">and</span> <span class="number">90</span> <span class="keyword">then</span> <span class="string">'优良'</span> </span><br><span class="line">     <span class="keyword">when</span> 平均分 <span class="keyword">between</span> <span class="number">70</span> <span class="keyword">and</span> <span class="number">80</span> <span class="keyword">then</span> <span class="string">'一般'</span></span><br><span class="line">     <span class="keyword">when</span> 平均分 <span class="keyword">between</span> <span class="number">60</span> <span class="keyword">and</span> <span class="number">70</span> <span class="keyword">then</span> <span class="string">'及格'</span></span><br><span class="line"><span class="keyword">else</span> <span class="string">'不及格'</span> <span class="keyword">end</span> <span class="string">"等级"</span></span><br><span class="line"><span class="keyword">from</span> V_studavgscoreCourseCountUp20</span><br></pre></td></tr></table></figure>    </p>
<p><img src="/2018/05/06/ORACLE之视图和系统函数/picsix.PNG" alt="picsix"></p>
<h4 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h4><ol>
<li>找出平均分最高的前 10 个学生成绩统计信息（包括学号、平均分、课程门数）</li>
</ol>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select studno,count (*)课程门数,avg(studscore)平均分 </span><br><span class="line"><span class="keyword">from</span> studscoreinfo</span><br><span class="line">group by studno</span><br></pre></td></tr></table></figure>    
<ol start="2">
<li>找出课程门数在 20 门以上的平均分最高前 10 个学生基本信息（包括学号、姓名、姓名、<br>班级编号、班级名称字段）</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">view</span> v_avgscoredesc <span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> studno,<span class="keyword">avg</span>(studscore)avgscore,<span class="keyword">count</span>(*) 课程门数</span><br><span class="line"><span class="keyword">from</span> studscoreinfo</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> studno</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">avg</span>(studscore) <span class="keyword">desc</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> studinfo</span><br><span class="line"><span class="keyword">where</span> studno <span class="keyword">in</span></span><br><span class="line">(</span><br><span class="line"><span class="keyword">select</span> studno <span class="keyword">from</span> v_avgscoredesc</span><br><span class="line"><span class="keyword">where</span> 课程门数 &gt;<span class="number">20</span> <span class="keyword">and</span> <span class="keyword">rownum</span> &lt;= <span class="number">10</span> </span><br><span class="line">)</span><br></pre></td></tr></table></figure>    
<ol start="3">
<li>课程类别为 A、B、C、D11、D12 为基础课和专业课，即统称为学位课，请统计“电信<br>01”班的各学生学位课的平均分、总分、课程所修门数、最高分、最低分。</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">View</span> v_电信<span class="number">01</span>同学成绩 <span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> studscoreinfo</span><br><span class="line"><span class="keyword">where</span> studno <span class="keyword">in</span></span><br><span class="line">(</span><br><span class="line"><span class="keyword">select</span> studno <span class="keyword">from</span> studinfo</span><br><span class="line"><span class="keyword">where</span> classid <span class="keyword">in</span></span><br><span class="line">(</span><br><span class="line"><span class="keyword">select</span> classid <span class="keyword">from</span> classinfo</span><br><span class="line"><span class="keyword">where</span> classname = <span class="string">'电信01'</span></span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">and</span> courseid <span class="keyword">in</span></span><br><span class="line">(</span><br><span class="line"><span class="keyword">select</span> courseid <span class="keyword">from</span> courseinfo</span><br><span class="line"><span class="keyword">where</span> coursetype = <span class="string">'A'</span> <span class="keyword">or</span> coursetype = <span class="string">'B'</span> <span class="keyword">or</span> coursetype = <span class="string">'D11'</span> <span class="keyword">or</span> coursetype = <span class="string">'D12'</span> </span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> studno,<span class="keyword">sum</span>(studscore) 总分,<span class="keyword">count</span>(*) 所修门数,<span class="keyword">max</span>(studscore) 最高分,<span class="keyword">min</span>(studscore) </span><br><span class="line"><span class="keyword">from</span> v_电信<span class="number">01</span>同学成绩</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> studno</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>创建学生平均成绩视图(ViewStudAvgScore)其中包括学生学号、学生姓名、平均分、总<br>分 、 最 高 分 、 最 低 分 、 课 程 门 数 ， 即<br>(StudNo,StudName,AvgScore,SumScore,MaxScore,MinScore, CountCourse)字段。</li>
</ol>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="built_in">replace</span> <span class="keyword">view</span> V_StudAvgScore <span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> ss.studno,s.studname ,<span class="built_in">avg</span>(studscore) avgscore,<span class="built_in">max</span>(studscore) 最高分,<span class="built_in">min</span>(studscore) 最低分,<span class="built_in">count</span>(*)课程门数</span><br><span class="line"><span class="keyword">from</span> studscoreinfo ss,studinfo s</span><br><span class="line"><span class="keyword">where</span> ss.studno = s.studno</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> ss.studno,s.studname</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> V_StudAvgScore</span><br></pre></td></tr></table></figure>    
<ol start="5">
<li>在视图(ViewStudAvgScore)中查询平均分在 80-85 和 60-70 之间的数据记录，其中包括学<br>生学号、学生姓名、班级名称、平均分、课程门数。</li>
</ol>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> v_Studavgscore</span><br><span class="line"><span class="keyword">where</span> (avgscore <span class="keyword">between</span> <span class="number">80</span> <span class="keyword">and</span> <span class="number">85</span>) <span class="keyword">or</span> (avgscore <span class="keyword">between</span> <span class="number">60</span> <span class="keyword">and</span> <span class="number">70</span>)</span><br></pre></td></tr></table></figure>    
<ol start="6">
<li>在视图(ViewStudAvgScore)中学生平均分大于 80 且课程门数为 30 门以上的男学生基本<br>信息，包括学号、姓名、性别、出生日期、班级、平均分、课程门数字段。</li>
</ol>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select s<span class="selector-class">.studno</span>,s<span class="selector-class">.studname</span>,studsex,studbirthday,classid,avgscore,课程门数</span><br><span class="line">from v_Studavgscore v ,studinfo s</span><br><span class="line">where v<span class="selector-class">.studno</span> = s<span class="selector-class">.studno</span> and avgscore &gt; <span class="number">80</span> and 课程门数 &gt;<span class="number">30</span> and  studsex = <span class="string">'男'</span></span><br></pre></td></tr></table></figure>
<ol start="7">
<li>创建一个序列（NewStudNo），初始值为 10001，步长为 1，最大值为 99999</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">sequence</span> NewStudNo</span><br><span class="line"><span class="keyword">increment</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">start</span> <span class="keyword">with</span> <span class="number">10001</span></span><br><span class="line">maxvalue   <span class="number">99999</span></span><br></pre></td></tr></table></figure>
<ol start="8">
<li>将农经 01 班的所有学生以题目 7 建立的序列号为学号存入新表<br>StudInfoSequence 中</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> stuinfosequence <span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> studname,studsex,studbirthday,classid <span class="keyword">from</span> studinfo</span><br><span class="line"><span class="keyword">where</span> classid</span><br><span class="line"><span class="keyword">in</span></span><br><span class="line">(</span><br><span class="line"><span class="keyword">select</span> classid <span class="keyword">from</span> classinfo</span><br><span class="line"><span class="keyword">where</span> classname = <span class="string">'农经01'</span> </span><br><span class="line">)</span><br></pre></td></tr></table></figure>    
<p>9.创建满足条件的学生平均分视图(ViewStudAvgScoreCourseCountUp20)，如果课程门数大<br>于 20 门，则去掉最高分、最低分，剩下的课程求平均。如果课程门数小于等于 20 门，<br>则所有对所有课程求平均。其中包括学生学号、学生姓名、平均分、总分、最高分、最<br>低 分 、 课 程 门 数 ， 即 (StudNo,StudName,AvgScore, SumScore,MaxScore,MinScore,<br>CourseCount)字段。</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> V_studavgscoreCourseCountUp20 <span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> ss.studno,s.studname,<span class="built_in">sum</span>(studscore) 总分,<span class="built_in">count</span>(*) 课程门数,<span class="built_in">max</span>(studscore) 最高分,<span class="built_in">min</span>(studscore) 最低分,</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">when</span> </span><br><span class="line">    <span class="built_in">count</span>(*) &gt; <span class="number">20</span> <span class="keyword">then</span> (<span class="built_in">sum</span>(studscore)-<span class="built_in">max</span>(studscore)-<span class="built_in">min</span>(studscore))/(<span class="built_in">count</span>(*)<span class="number">-2</span>)</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">avg</span>(studscore) <span class="keyword">end</span> 平均分</span><br><span class="line"><span class="keyword">from</span> studscoreinfo ss,studinfo s</span><br><span class="line"><span class="keyword">where</span> ss.studno = s.studno</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> ss.studno,s.studname</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> V_studavgscoreCourseCountUp20</span><br></pre></td></tr></table></figure>
<ol start="10">
<li>在学生成绩信息表(StudScoreInfo)和学生信息表(StudInfo)中将求出的平均分按以下等级输出。（包括学号，姓名，性别，出生日期，平均分，等级字段）<br>平均分 等级<br>90—100 ‘优秀’<br>80—90 ‘优良’<br>70—80 ‘一般’<br>60—70 ‘及格’<br>60 以下 ‘不及格’</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> studno,studname, 平均分,</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">when</span> 平均分 <span class="keyword">between</span> <span class="number">90</span> <span class="keyword">and</span> <span class="number">100</span> <span class="keyword">then</span> <span class="string">'优秀'</span></span><br><span class="line">     <span class="keyword">when</span> 平均分 <span class="keyword">between</span> <span class="number">80</span> <span class="keyword">and</span> <span class="number">90</span> <span class="keyword">then</span> <span class="string">'优良'</span> </span><br><span class="line">     <span class="keyword">when</span> 平均分 <span class="keyword">between</span> <span class="number">70</span> <span class="keyword">and</span> <span class="number">80</span> <span class="keyword">then</span> <span class="string">'一般'</span></span><br><span class="line">     <span class="keyword">when</span> 平均分 <span class="keyword">between</span> <span class="number">60</span> <span class="keyword">and</span> <span class="number">70</span> <span class="keyword">then</span> <span class="string">'及格'</span></span><br><span class="line"><span class="keyword">else</span> <span class="string">'不及格'</span> <span class="keyword">end</span> <span class="string">"等级"</span></span><br><span class="line"><span class="keyword">from</span> V_studavgscoreCourseCountUp20</span><br></pre></td></tr></table></figure>
<ol start="11">
<li>统计“可视化程序设计”课程各分数段的人数，结果结构如下所示：<br>成绩 等级 人数<br>90—100 ‘优秀’ 66<br>80—90 ‘优良’ 90<br>70—80 ‘一般’ 84<br>60—70 ‘及格’ 80<br>60 以下 ‘不及格’ 19</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> courseinfo</span><br><span class="line"><span class="keyword">where</span> coursename = <span class="string">'可视化程序设计'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="string">'[90-100]'</span> 分数段,<span class="string">'优秀'</span> 等级 ,<span class="keyword">count</span>(*) 人数</span><br><span class="line"><span class="keyword">from</span> studscoreinfo</span><br><span class="line"><span class="keyword">where</span> courseid = <span class="string">'KSHCX011'</span> <span class="keyword">and</span> studscore <span class="keyword">between</span> <span class="number">90</span> <span class="keyword">and</span> <span class="number">100</span></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">'[80-90]'</span> 分数段, <span class="string">'优良'</span> 等级 ，<span class="keyword">count</span>(*) 人数</span><br><span class="line"><span class="keyword">from</span> studscoreinfo</span><br><span class="line"><span class="keyword">where</span> courseid = <span class="string">'KSHCX011'</span> <span class="keyword">and</span> studscore <span class="keyword">between</span> <span class="number">80</span> <span class="keyword">and</span> <span class="number">90</span></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">'[70-80]'</span> 分数段, <span class="string">'一般'</span> 等级 ，<span class="keyword">count</span>(*) 人数</span><br><span class="line"><span class="keyword">from</span> studscoreinfo</span><br><span class="line"><span class="keyword">where</span> courseid = <span class="string">'KSHCX011'</span> <span class="keyword">and</span> studscore <span class="keyword">between</span> <span class="number">70</span> <span class="keyword">and</span> <span class="number">80</span></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">'[60-70]'</span> 分数段, <span class="string">'及格'</span> 等级 ，<span class="keyword">count</span>(*) 人数</span><br><span class="line"><span class="keyword">from</span> studscoreinfo</span><br><span class="line"><span class="keyword">where</span> courseid = <span class="string">'KSHCX011'</span> <span class="keyword">and</span> studscore <span class="keyword">between</span> <span class="number">60</span> <span class="keyword">and</span> <span class="number">70</span></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">'[60以下]'</span> 分数段, <span class="string">'不及格'</span> 等级 ，<span class="keyword">count</span>(*) 人数</span><br><span class="line"><span class="keyword">from</span> studscoreinfo  </span><br><span class="line"><span class="keyword">where</span> courseid = <span class="string">'KSHCX011'</span> <span class="keyword">and</span> studscore &lt;<span class="number">60</span></span><br></pre></td></tr></table></figure>
<ol start="12">
<li>查询姓名为三个字，且以丽字结尾的学生成绩信息。（注：使用 Like 和函数 SubStr 两种<br>方法完成）</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">A.</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> studinfo</span><br><span class="line"><span class="keyword">where</span> studname <span class="keyword">like</span> <span class="string">'__丽'</span></span><br><span class="line"></span><br><span class="line">B.</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> studinfo</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">length</span>(studname) = <span class="number">3</span> <span class="keyword">and</span> (<span class="keyword">instr</span>(studname,<span class="string">'丽'</span>) = <span class="number">2</span> <span class="keyword">or</span> <span class="keyword">instr</span>(studname,<span class="string">'丽'</span>) = <span class="number">3</span>)</span><br></pre></td></tr></table></figure>    
<ol start="13">
<li>将学生信息表中所有姓“刘”的学生更改成姓“牛”。</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> studinfo <span class="keyword">set</span> studname =  (<span class="string">'牛'</span> || <span class="keyword">substr</span>(studname,<span class="number">2</span>)) </span><br><span class="line"><span class="keyword">where</span> studname <span class="keyword">in</span> </span><br><span class="line">(</span><br><span class="line"><span class="keyword">select</span> studname <span class="keyword">from</span> studinfo</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">instr</span>(studname,<span class="string">'刘'</span>) = <span class="number">1</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="keyword">select</span> studname <span class="keyword">from</span> studinfo <span class="keyword">where</span> <span class="keyword">instr</span>(studname,<span class="string">'牛'</span>)= <span class="number">1</span> </span><br></pre></td></tr></table></figure>
<ol start="14">
<li>找出相同性别且相同生日出生的学生。</li>
</ol>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> view V_samesexsambir <span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> studsex,studbirthday,count<span class="comment">(*) count from studinfo</span></span><br><span class="line"><span class="comment">group by studsex,studbirthday</span></span><br><span class="line"><span class="comment">having count(*)</span> &gt;<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> studinfo</span><br><span class="line"><span class="keyword">where</span> studbirthday</span><br><span class="line"><span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> studbirthday <span class="keyword">from</span> V_samesexsambir )</span><br></pre></td></tr></table></figure>   
<ol start="15">
<li>找出出生日期为空值的学生平均分成绩信息。</li>
</ol>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select studno,avg(studscore) 平均分</span><br><span class="line"><span class="keyword">from</span> studscoreinfo </span><br><span class="line">where studno <span class="keyword">in</span></span><br><span class="line">(</span><br><span class="line">select studno <span class="keyword">from</span> studinfo where studbirthday is <span class="literal">null</span></span><br><span class="line">)</span><br><span class="line">group by studno</span><br></pre></td></tr></table></figure>    
<ol start="16">
<li>找出所有姓“王”的各学生平均分比所有姓“李”的各学生平均分高的学生成绩统计信<br>息。</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> V_StudAvgScore</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">instr</span>(studname,<span class="string">'王'</span>) = <span class="number">1</span> <span class="keyword">and</span> avgscore &gt;</span><br><span class="line">(</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">max</span>(avgscore) <span class="keyword">from</span> V_StudAvgScore</span><br><span class="line"><span class="keyword">where</span> studno <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> studno <span class="keyword">from</span> V_StudAvgScore</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">instr</span>(studname,<span class="string">'李'</span>) = <span class="number">1</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h4><p>到目前为止，关于数据库的文章我打算告一段落(共计7篇文章),估计以后还会出关于数据库的文章，毕竟这些知识只是基础知识，也可能会出Mysql的博客，当时是为复习oracle而开始了第一篇文章的，像这样的一边博客我是要写5，6个小时的，如果算上之前的学习和练习，大概3天能出上这样一篇博客，虽然很消耗时间，但是我还是坚持了下来，计算机很多东西，我会弄，会做，但只是<br>知其然，但写博客就要求我知其所以然，它的原理是什么,这是我愿意坚持下去的原因之一。</p>
<h4 id="投喂我"><a href="#投喂我" class="headerlink" title="投喂我"></a>投喂我</h4><p>写文不易，如果本文对你有帮助，点击Donate,微信和支付宝投喂我</p>
</div><iframe src="/donate/?AliPayQR=/img/AliPayQR.jpg&amp;WeChatQR=/img/WeChatQR.png&amp;GitHub=null&amp;BTCQR=null&amp;BTCKEY=null&amp;PayPal=null" style="overflow-x:hidden; overflow-y:hidden; border:0xp none #fff; min-height:240px; width:100%;" frameborder="0" scrolling="no"></iframe><div class="tags"></div><div class="post-nav"><a class="pre" href="/2018/05/19/Mariadb基本配置/">Mariadb基本配置</a><a class="next" href="/2018/05/03/SQL之高级查询/">SQL之高级查询</a></div><div id="lv-container" data-id="city" data-uid="MTAyMC8zNTcwNS8xMjI0MQ=="><script>(function(d, s) {
   var j, e = d.getElementsByTagName(s)[0];
   if (typeof LivereTower === 'function') { return; }
   j = d.createElement(s);
   j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
   j.async = true;
   e.parentNode.insertBefore(j, e);
})(document, 'script');
</script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="http://yoursite.com"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/07/16/Pattern-抽象工厂模式/">Pattern]抽象工厂模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/10/DesignPattern-FactoryPattern/">[DesignPattern]FactoryPattern</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/08/Python3爬虫-selenium-chromedriver可见即可爬/">[Python3爬虫]selenium+chromedriver可见即可爬</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/02/Python3-Ajax请求信息的爬取/">[Python3]Ajax请求信息的爬取</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/18/Python3爬虫-Beautiful-Soup解析库/">[Python3爬虫]Beautiful Soup解析库</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/02/数据结构-Josephus-problem/">[数据结构]Josephus problem</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/25/Python3爬虫-Requests库高级用法/">[Python3爬虫]Requests库高级用法</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/23/Python3爬虫-requests库基本使用/">[Python3爬虫]requests库基本使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/19/Mariadb基本配置/">Mariadb基本配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/06/ORACLE之视图和系统函数/">ORACLE之视图和系统函数</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">Yhchdev.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async="async"></script><span id="busuanzi_container_site_pv">|访问量<span id="busuanzi_value_site_pv"></span></span><span id="busuanzi_container_site_uv">|访客数<span id="busuanzi_value_site_uv"> </span></span></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>